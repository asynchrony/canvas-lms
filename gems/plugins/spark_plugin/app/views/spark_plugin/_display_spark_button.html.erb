<span id="enable_spark_button"></span>
<script>
  document.addEventListener("DOMContentLoaded", function(event) {
    ajaxRequest({
      type: "GET",
      url: window.location.pathname + "/enable-spark-button"
    }, function(xhr) {
      executeScript(xhr.responseText);
    });
  });

  function ajaxRequest(options, successCallback) {
    var xhr = new window.XMLHttpRequest();

    xhr.onreadystatechange = function() {
      if(xhr.readyState === 4 && xhr.status === 200) {
        successCallback(xhr);
      }
    };

    xhr.open(options.type, options.url, true);
    xhr.setRequestHeader('X-Requested-With', 'XMLHttpRequest');
    xhr.send();
  }

  function executeScript(text) {
    var script = document.createElement('script');
    document.head.appendChild(script);
    script.text = text;
  }
</script>
